<!DOCTYPE html><html>	<head>		<meta charset="utf-8">		<title>Thesis</title>		<style>			html, body {				width: 100%;				height: 100%;			}			body {				background-color: #ffffff;				margin: 0;				overflow: hidden;				font-family: arial;			}			#blocker {				position: absolute;				width: 100%;				height: 100%;				background-color: rgba(255,255,255,0);			}			#instructions {				width: 100%;				height: 100%;				display: -webkit-box;				display: -moz-box;				display: box;				-webkit-box-orient: horizontal;				-moz-box-orient: horizontal;				box-orient: horizontal;				-webkit-box-pack: center;				-moz-box-pack: center;				box-pack: center;				-webkit-box-align: center;				-moz-box-align: center;				box-align: center;				color: #000000;				text-align: center;				cursor: pointer;			}			#container{				width:100%;				height:100%;			}			@font-face {			    font-family: 'Domaine';			    src: url('fonts/GT-Cinetype-Trial-Regular.otf');			}			.loadFont {				position: absolute;				z-index: -9999;			}			.loader2 {			position: fixed;			left: 0px;			top: 0px;			width: 100%;			height: 100%;			z-index: 9999;			background: url('images/sky/posy.jpg') 50% 50% no-repeat rgb(0,0,0);			}			.pace {			  -webkit-pointer-events: none;			  pointer-events: none;			  -webkit-user-select: none;			  -moz-user-select: none;			  user-select: none;			}			.pace-inactive {			  display: none;			}			.pace .pace-progress {			  background: #0000ff;			  position: fixed;			  z-index: 2000;			  top: 0;			  right: 100%;			  width: 100%;			  height: 10px;			}		</style>		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 	</head>	<body>						<script src="js/three.js"></script>		<script src="js/StereoEffect.js"></script>		<script src="js/DeviceOrientationControls.js"></script>  <script src="js/OrbitControls.js"></script>		<script src="js/Projector.js"></script>		<script src="js/CanvasRenderer.js"></script>		<script src="js/functions.js"></script>		<script src="js/stats.min.js"></script>		<script src="js/pace.min.js"></script>		<script type="text/javascript" src="js/THREEx.screenshot.js"></script>		<script src="js/STLLoader.js"></script>		<div class="loadFont" style="font-family: Domaine;">Domaine</div>		<div id="blocker">			<div id="instructions">				<span style="font-size:40px, font-family: Domaine, color: rgb(20,20,255);"></span>				<br />							</div>		</div>		<div id="container"></div>		<div id="videos">				</div>		<script>			var skyColor = 0xffdddd;			var fogColor = 0xffdddd;			var floorColor = 0xffffff;			var lightColor = 0xeeeeee;			var objectColor = 0xffffff;			var ambientColor = 0x222222;			var textColor =0xff9999;			var fogDensity = 0.00035;			var camera, scene, renderer, effect;			var geometry, material, mesh;			var floor;			var controls;			var stats;			var t;			var title;			var displayTitle = true;			var titles = [];			var initX = 0;			var initY = 0;			var initZ = 0;			var stars = [];			var objects = [];			var rooms = [];			var lookAtMe = [];			var spinList = [];			var raycaster, rayForward, rayRight, rayLeft, rayBack;			var arrowForward;			var blocker = document.getElementById( 'blocker' );			var instructions = document.getElementById( 'instructions' );			var directionalLight;			var c_blue = "rgb(0,0,0)";			var notification;			var mouse = new THREE.Vector2();			var myPosition, myBody, myHead;			var cameraDirection;			var testCube;			var myHeight = 100;			var speed = 3;			// var dLightX = -1500;			// var dLightY = 1700;			// var dLightZ = -900;			var dLightX = 1500;			var dLightY = 2500;			var dLightZ = -1900;						var controlsEnabled = false;			var moveForward = false;			var moveBackward = false;			var moveLeft = false;			var moveRight = false;			var bSprint = false;			var crouch = false;			var prevTime = performance.now();			var velocity = new THREE.Vector3();			var canJump = true;						var loader;			var mesh;			var david;			//sky			var skyboxMesh;			var cameraCube, sceneCube;			var videos = [{name : "c2", source: "videos/c02_1.mp4"},			{name : "aska", source: "videos/AskaTanoto.mp4"},			{name : "aska2", source: "videos/AskaTanoto_cat.mp4"},			{name : "ZZ1", source: "videos/c03.mp4"},			{name : "zz2", source: "videos/ZipengZhu_02.mp4"},			{name : "c4", source: "videos/c04.mp4"},			{name : "u1", source: "videos/u01_2.mp4"}];			// console.log(videos[0].source);			var videoInfo = [];						window.onload = function ()			{			//initPointerLock();			init();			animate();			};			function init() {				t = 0;				loader = new THREE.STLLoader();				initX = getParameterByName('x');				initX = getParameterByName('y');				initX = getParameterByName('z');				// CAMERAS				var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;				var VIEW_ANGLE = 45, ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT, NEAR = 1, FAR = 10000;				camera = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR );				//camera.position.set(initX,initY,initZ);				//effect = new THREE.StereoEffect( renderer );				scene = new THREE.Scene();				//scene.fog = new THREE.Fog( fogColor,700,4500);				scene.fog = new THREE.FogExp2( fogColor,fogDensity);				//initSky();				controls = new THREE.OrbitControls(camera, element);			      controls.rotateUp(Math.PI / 4);			      controls.target.set(			        camera.position.x + 0.1,			        camera.position.y,			        camera.position.z			      );			      controls.noZoom = true;			      controls.noPan = true;			      function setOrientationControls(e) {			        if (!e.alpha) {			          return;			        }			        controls = new THREE.DeviceOrientationControls(camera, true);			        controls.connect();			        controls.update();			        element.addEventListener('click', fullscreen, false);			        window.removeEventListener('deviceorientation', setOrientationControls, true);			      }			      window.addEventListener('deviceorientation', setOrientationControls, true);				// controls = new THREE.PointerLockControls( camera );				// scene.add( controls.getObject() );				// myPosition = controls.getObject().position;				// cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone();				//THREEx.Screenshot.bindKey(renderer);				var onKeyDown = function ( event ) {					switch ( event.keyCode ) {						case 16:							bSprint = true;							break;						case 38: // up						case 87: // w							moveForward = true;							break;						case 37: // left						case 65: // a							moveLeft = true; break;						case 40: // down						case 83: // s							moveBackward = true;							break;						case 39: // right						case 68: // d							moveRight = true;							break;						case 32: // space							if ( canJump === true ) velocity.y += 650;							canJump = false;							break;						case 67: //c							crouch = true;					}				};				var onKeyUp = function ( event ) {					switch( event.keyCode ) {						case 16:							bSprint = false;							break;						case 38: // up						case 87: // w							moveForward = false;							break;						case 37: // left						case 65: // a							moveLeft = false;							break;						case 40: // down						case 83: // s							moveBackward = false;							break;						case 39: // right						case 68: // d							moveRight = false;							break;						case 67: //c							crouch = false;							break;						case 80:						window.open( renderer.domElement.toDataURL("image/png"), "Final");						break;					}				};				document.addEventListener( 'keydown', onKeyDown, false );				document.addEventListener( 'keyup', onKeyUp, false );				raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0  ));				// init collision rays				rayForward = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, 0, -1  ),0,50);				rayRight = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 1, 0, 0  ),0,50);				rayBack = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, 0, 1  ),0,50);				rayLeft = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( -1, 0, 0  ),0,50);				rayDown = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, -1, 0  ),0,100);				rayStairs = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, 0, -1  ),0,30);				var dir = new THREE.Vector3( 0, 0, -1 );				var origin = new THREE.Vector3( 0, 0, 0 );				var length = 20;				var hex = 0xff0000;				arrowForward = new THREE.ArrowHelper( dir, origin, length, hex );				scene.add( arrowForward );				//make floor				makeFloor();				//set lights				initLights();				//placeSTL("obj/title.stl",0,50,-100,0, 0x000000,THREE.FrontSide, "lambert",true, false,"mesh.scale.set(0.12,0.12,0.10); mesh.rotation.x=-Math.PI/7");				//titles				var title1 = placeTitle("A VIRTUAL SPACE", 0,0,-150, c_blue,window.innerWidth/12);				var title2 = placeTitle("A Thesis", 0,0,-150, c_blue,window.innerWidth/12);				var title3 = placeTitle("on Virtual Reality", 0,0,-150, c_blue,window.innerWidth/12);				var title5 = placeTitle("Click to Enter", 0,0,-150, c_blue,window.innerWidth/12);				var title4 = placeTitle("by Pedro Sanches", 0,0,-150, c_blue,window.innerWidth/12);				titles.push(title1);				titles.push(title2);				titles.push(title3);				titles.push(title4);				titles.push(title5);				for (var i = 0; i < titles.length; i++) {					titles[i].lookAt(myPosition);					titles[i].visible = false;				};				titles[0].visible = true;				var titlePostion = myPosition.clone();						titlePostion.x += cameraDirection.x*-200;						 titlePostion.y += cameraDirection.y*200;						titlePostion.z += cameraDirection.z*200;						for (var i = 0; i < titles.length; i++) {							titles[i].position.set(titlePostion.x, titlePostion.y-50, titlePostion.z);							titles[i].lookAt(myPosition);							//console.log(i);						};								//render things in order of shader				var allRotation = 4*Math.PI/5;				var allPosition = new THREE.Vector3(-2000,-1,-000);				placeSTL("obj/r2/rooms/entrance.stl",allPosition,allRotation, 0xFFFFFF,THREE.FrontSide, "lambert",true, true,"");				placeSTL("obj/r2/rooms/plaza.stl",allPosition,allRotation, 0xFFFFFF,THREE.FrontSide, "lambert",true, true,"");				placeSTL("obj/r2/rooms/AB.stl",allPosition,allRotation, 0xFFFFFF,THREE.FrontSide, "lambert",true, true,"");				placeSTL("obj/r2/rooms/C.stl",allPosition,allRotation, 0xFFFFFF,THREE.FrontSide, "lambert",true, true,"");				placeSTL("obj/r2/rooms/credits.stl",allPosition,allRotation, 0xFFFFFF,THREE.FrontSide, "lambert",true, true,"");				// placeSTL("obj/r2/rooms/map.stl",allPosition,allRotation, 0xFFFFFF,THREE.FrontSide, "lambert",true, true,"");				//-10298 , 2291 , 5818			placeSTL("obj/r2/sculptures/david.stl",allPosition,allRotation, 0xFFFFFF,THREE.FrontSide, "lambert",true, true,"");			placeSTL("obj/r2/sculptures/thinker.stl",allPosition,allRotation, 0x999999,THREE.FrontSide, "lambert",true, true,"");			placeSTL("obj/r2/sculptures/cube.stl",allPosition,allRotation, 0xffffff,THREE.FrontSide, "basic",true, false,"");			-12587 , 149 , 7610			placeSTL("obj/r2/sculptures/links.stl",new THREE.Vector3(-12587 , 149 , 7610), 0, 0xFFFFFF,THREE.FrontSide, "lambert",true, true,"");						placeSTL("obj/r2/sculptures/couch.stl",new THREE.Vector3(-12698 , 2291 -150, 7583), 4*Math.PI/5 + Math.PI/2, 0xFFFFFF,THREE.FrontSide, "lambert",true, true,"mesh.scale.set(2,2,2)");			//placeSTL("obj/r2/sculptures/toilet.stl",new THREE.Vector3(-10282 , 1409 -150, 7584), 4*Math.PI/5 + Math.PI/3, 0xFFFFFF,THREE.FrontSide, "lambert",true, true,"mesh.scale.set(6,6,6)");				placeSTL("obj/r2/cuberoom.stl",new THREE.Vector3(allPosition.x,allPosition.y+1,allPosition.z),allRotation, 0x0000FF,THREE.FrontSide, "basic",false, false,"mesh.scale = new THREE.Vector3(0.99,0.99,0.99); 	");				//initStars(0,0,0,100);								var textObjects = ["01content","A02","A03","012newMedia","02structure","021spaces2","023rooms","B_links","021spaces","021spaces3","011text"];				for (var i = 0; i < textObjects.length; i++) {					placeSTL("obj/r2/text/"+textObjects[i]+".stl",allPosition,allRotation, 0xff9999,THREE.BackSide, "basic",false, false,					"");				};				placeText("This Space is a little rough around the edges. You might get stuck; consider jumping. To your right is more thesis-like, to your left is a little less serious. Down to the back can get a little dark... Or not.",-5149 , 405 , 5983 ,4*Math.PI/5,3000, c_blue,150);												placeText("Virtual Spaces, from what I can gather from making this space will probably be standerdized in many ways. Like the Web. People will build specific formats and like a version of a 3D .GIF",-10831 , 468 , 4797 ,4*Math.PI/5 - Math.PI/2,3000, "#ff9999",100);				// placeText("Virtual Spaces, from what I can gather from making this space will probably be standerdized in many ways. Like the Web. People will build",-10732 , 468 , 5078,4*Math.PI/5 ,3000, textColor,50); 				 				var robertFrostPoem1 = "Two roads diverged in a yellow wood, And sorry I could not travel both And be one traveler, long I stood And looked down one as far as I could To where it bent in the undergrowth; Then took the other, as just as fair, And having perhaps the better claim, Because it was grassy and wanted wear;" 					var robertFrostPoem2 = "Though as for that the passing there Had worn them really about the same, And both that morning equally lay In leaves no step had trodden black. Oh, I kept the first for another day! Yet knowing how way leads on to way, I doubted if I should ever come back. I shall be telling this with a sigh Somewhere ages and ages hence: Two roads diverged in a wood, and Iâ€” I took the one less traveled by, And that has made all the difference. - Robert Frost" 				placeText(robertFrostPoem1,-12955 , 1595 -500, 7601 ,4*Math.PI/5 - Math.PI/2,1000, "#ff9999",50); 				placeText(robertFrostPoem2,-12955 , 1095 -500, 7601 ,4*Math.PI/5 - Math.PI/2,1000, "#ff9999",50); 				var textSpaces = "Virtual Spaces are infinite, But there are limits in computer power" 				placeText(textSpaces,-12901 , 1047 , 8650 ,4*Math.PI/5 - Math.PI/2,1000, "#ff9999",50); 				 				var textSpaces = "links!" 				placeText(textSpaces,-12534 , 149 , 7590,4*Math.PI/5 - Math.PI/2,1000, "#ff9999",50); 				-3000 , 468 , 15087 				var creditString = " This website was done using threejs ect... "; 				placeText(creditString ,-3000 , 468 , 15087,4*Math.PI/5 - Math.PI/2,1000, "#ff9999",150);				//images				var mona = placeImg("images/mona.jpg",-12796 , 1296 , 8244,4*Math.PI/5,1,"basic",false);				mona.scale = new THREE.Vector3(2,2,2);;								spinList.push(placeImg("images/Kreylos.jpg",-10156 , 2291 +100, 6884 , 0.4720567881891803,0.5,"lambert",true));				spinList.push(placeImg("images/Leo Porto.jpg",-10635 , 2291 +100, 6091 , 0.4720567881891803,0.5,"lambert",true));				spinList.push(placeImg("images/unkown 01.jpg",-10508 , 2291 +100, 4826 , 0.4720567881891803,0.5,"lambert",true));				spinList.push(placeImg("images/unkown 02.jpg",-11443 , 2291 +100, 5573 , -0.9737509645198594 , 0.4720567881891803,0.5,"lambert",true));								spinList.push(placeImg("images/Walter Pichler 01.jpg",-11430 , 2291+100 , 6780 , -0.9737509645198594 , 0.4720567881891803,0.5,"lambert",true));				spinList.push(placeImg("images/Walter Pichler 02.jpg",-10496 , 2291 +100, 6237, -0.9737509645198594 , 0.4720567881891803,0.5,"lambert",true));				spinList.push(placeImg("images/windows.jpg",-9624 , 2291 +100, 4295, -0.9737509645198594 , 0.4720567881891803,0.5,"lambert",true));								spinList.push(placeImg("images/santi.png",-11214 , 2291 +200, 5111, -0.9737509645198594 , 0.4720567881891803,0.5,"lambert",true));				//links				placeImg("images/Minoru Nomata.jpg",	-12223 , 149 , 8035, 2*Math.PI/5, 0.4720567881891803,0.5,"lambert",true);				placeImg("images/Michael Whelan.jpg",	-12584 , 149 , 8071, 1*Math.PI/5, 0.4720567881891803,0.1,"lambert",true);				//rooms							placeImg("images/MassimoUberti01.jpg",	-13579 , 149 , 8470, 4*Math.PI/5, 0.4720567881891803,0.5,"lambert",true);				placeImg("images/ThierryUrbain.jpg",	-14369 , 149 , 8740, 4*Math.PI/5, 0.4720567881891803,0.5,"lambert",true);				placeImg("images/RemKoolhaas.jpg",	-14418 , 149 , 8251, 4*Math.PI/5, 0.4720567881891803,0.5,"lambert",true);												//dark room								lookAtMe.push(placeImg("images/lightphone01.jpeg",-11227 , 200, 14440, -0.9737509645198594 , 0.4720567881891803,0.5,"basic",false));								lookAtMe.push(placeImg("images/lightphone02.jpg",-12717 , 200 , 13211, -0.9737509645198594 , 0.4720567881891803,0.5,"basic",false));				lookAtMe.push(placeImg("images/AndrewHerzog_MetaGoogle.jpg",-11616 , 200 , 12736, -0.9737509645198594 , 0.4720567881891803,0.4,"basic",false));								lookAtMe.push(placeImg("images/mollyoreo.jpg",-9623 , 200 , 15758, -0.9737509645198594 , 0.4720567881891803,0.4,"basic",false));								lookAtMe.push(placeImg("images/AndrewHerzog_gunplane.jpg",-10491 , 200 , 15407, -0.9737509645198594 , 0.4720567881891803,0.4,"basic",false));				lookAtMe.push(placeImg("images/CarolineBagley_Glitch01.png",-9331 , 200 , 14262, -0.9737509645198594 , 0.4720567881891803,0.4,"basic",false));								lookAtMe.push(placeImg("images/CarolineBagley_Glitch02.png",-9164 , 200 , 15191 , -0.9737509645198594 , 0.4720567881891803,0.2,"basic",false));				lookAtMe.push(placeImg("images/voldemort_on_titanic_____by_awesmatasticaly_cool-d4tj56v.jpg",-12197 , 200 , 14156  , -0.9737509645198594 , 0.4720567881891803,0.2,"basic",false));				lookAtMe.push(placeImg("images/SimonSeuplveda01.png",-12197 , 200 , 13231, -0.9737509645198594 , 0.4720567881891803,0.2,"basic",false));				lookAtMe.push(placeImg("images/sony.jpg",-12296 , 200 , 12177 , -0.9737509645198594 , 0.4720567881891803,0.2,"basic",false));				lookAtMe.push(placeImg("images/sky/1.jpg",-12801 , 200 , 12414 , -0.9737509645198594 , 0.4720567881891803,0.2,"basic",false));				lookAtMe.push(placeImg("images/sky/2.jpg",-12289 , 200 , 13935 , -0.9737509645198594 , 0.4720567881891803,0.2,"basic",false));				for (var i = 1 ; i <8; i++) {					lookAtMe.push(placeImg("images/darkroom/0"+i+".jpg",-11227 +Math.random()*1500 -500, 200, 14440+Math.random()*1500-500, -0.9737509645198594 , 0.4720567881891803,0.5,"basic",false));				}								//spinList.push(placeImg("images/unkown 02.jpg",-11443 , 2291 , 5573 , -0.9737509645198594 , 0.4720567881891803,0.5,"lambert",true));				// var imgWindows = placeImg("images/windows.jpg",-12283 , 1095 , 8308,1,"lambert",false);								//-12494 , 1095 , 7710				videoInfo.push(placeVideo(videos[0].name,videos[0].source,-12027 , 1095 , 8297,284*2,400*2));				videoInfo[videoInfo.length-1].object.rotation.y += Math.PI/2								videoInfo.push(placeVideo(videos[1].name,videos[1].source,-9863 , 149 , 14726,190,190));				lookAtMe.push(videoInfo[videoInfo.length-1].object);				videoInfo.push(placeVideo(videos[2].name,videos[2].source,-11605 , 149 , 13772,300,300));				lookAtMe.push(videoInfo[videoInfo.length-1].object);				videoInfo.push(placeVideo(videos[3].name,videos[3].source,-10683 , 149 , 14418,1600,600));				lookAtMe.push(videoInfo[videoInfo.length-1].object);				videoInfo.push(placeVideo(videos[4].name,videos[4].source,-9963 , 149 , 14171,300,300));				lookAtMe.push(videoInfo[videoInfo.length-1].object);												spinList.push(placeImg("images/test1/1.jpg",-9388 , 468 , 4450 , 0.4720567881891803,0.5,"lambert",true));				//placeImg("images/test1/1.jpg",-948 , 149 , 349 , 0.4720567881891803,0.5,"lambert",false);				// spinList.push(placeImg("images/test1/2.jpg",-9339 , 468 , 5524,"lambert",false));				// lookAtMe.push(placeImg("images/test1/3.jpg",-9639 , 468 , 5224,"lambert",false));				// spinList.push(placeImg("images/test1/4.jpg",-9139 , 468 , 5724,"lambert",true));				// lookAtMe.push(placeImg("images/test1/5.jpg",-9939 , 468 , 5824,"lambert",false));								notification = initNotification("",c_blue);							renderer = new THREE.WebGLRenderer({antialias:true,preserveDrawingBuffer : true, devicePixelRatio:0.25});				renderer.setClearColor( skyColor );				renderer.setPixelRatio( window.devicePixelRatio );				renderer.setSize( window.innerWidth, window.innerHeight );				//renderer.autoClear = false;				renderer.shadowMapEnabled = true;				effect = new THREE.StereoEffect( renderer );				effect.setSize( window.innerWidth, window.innerHeight );				document.body.appendChild( renderer.domElement );				//				var container = document.getElementById( 'container' );				container.appendChild( renderer.domElement );				// stats = new Stats();				// stats.domElement.style.position = 'absolute';				// stats.domElement.style.top = '0px';				// stats.domElement.style.right = '-63px';				// container.appendChild( stats.domElement );				window.addEventListener( 'resize', onWindowResize, false );			}			function onWindowResize() {				camera.aspect = window.innerWidth / window.innerHeight;				camera.updateProjectionMatrix();				renderer.setSize( window.innerWidth, window.innerHeight );				effect.setSize( window.innerWidth, window.innerHeight );			}			function animate() {				t+=0.001;				//animateStars()				//directionalLight.position.set( Math.sin(t)*2000, Math.sin(t)*1400+1800, Math.cos(t)*2000 );				   setTimeout( function() {				        requestAnimationFrame( animate );				    }, 1000 / 40 );				//requestAnimationFrame( animate );				if( displayTitle) {					setTimeout(function(){						var count = Math.floor((t/4)%titles.length);						for (var i = 0; i < titles.length; i++) {							titles[i].visible = false;						};												titles[count].visible = true;																}, 1000)				}								//teleport to url position				// controls.getObject().position.x = 500;				// controls.getObject().position.z = initZ;				if (controls.enabled == false){					t+=0.1;				}								if ( controlsEnabled ) {					if ( bSprint) {						speed = 6;					} else {						speed= 3;					}					if ( crouch ) {						myHeight = 30;					} else {						myHeight = 100;					}					myPosition = controls.getObject().position;					cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone();					//raycaster.ray.origin.copy( controls.getObject().position );								var time = performance.now();					var delta = ( time - prevTime ) / 1000;					velocity.x -= velocity.x * 5.0 * delta;					velocity.z -= velocity.z * 5.0 * delta;					velocity.y -= 5.8 * 100.0 * delta; // 100.0 = mass										if ( moveForward ) velocity.z -= 400.0 * delta *2;					if ( moveBackward ) velocity.z += 400.0 * delta *2;					if ( moveLeft ) velocity.x -= 400.0 * delta *2;					if ( moveRight ) velocity.x += 400.0 * delta *2;					//CHECK COLLISIONS//					////////////////////										//cameraCube.rotation.copy( cameraDirection );					var rayPosition = controls.getObject().position.clone();										rayPosition.y -= 70;					rayStairs.set(rayPosition , new THREE.Vector3(cameraDirection.x,0,cameraDirection.z) );					//arrowForward.position=rayPosition;					rayPosition.y += 20;					rayForward.set(rayPosition , new THREE.Vector3(cameraDirection.x,0,cameraDirection.z) );										//rotate vector to get camera's right direction					var axis = new THREE.Vector3( 0, 1, 0 );					var angle = Math.PI / 2;					cameraDirection.applyAxisAngle( axis, angle );					rayLeft.set(rayPosition , new THREE.Vector3(cameraDirection.x,0,cameraDirection.z) );										//repeat for all sides					angle += Math.PI / 2;					cameraDirection.applyAxisAngle( axis, angle );					rayRight.set(rayPosition , new THREE.Vector3(cameraDirection.x,0,cameraDirection.z) );										//repeat for all sides					angle += Math.PI / 2;					cameraDirection.applyAxisAngle( axis, angle );					rayBack.set(rayPosition , new THREE.Vector3(cameraDirection.x,0,cameraDirection.z) );								//ray down					rayDown.set(rayPosition, new THREE.Vector3(0,-1,0));					//check for rayhits					var hitsLeft = rayLeft.intersectObjects(rooms);					var hitsForward = rayForward.intersectObjects(rooms);					var hitsRight = rayRight.intersectObjects(rooms);					var hitsBack = rayBack.intersectObjects(rooms);					var hitsDown = rayDown.intersectObjects(rooms);					var hitStairs = rayStairs.intersectObjects(rooms);					//put results in boolean					var isHitLeft = hitsLeft.length > 0;					var isHitForward = hitsForward.length > 0;					var isHitRight = hitsRight.length > 0;					var isHitBack = hitsBack.length > 0;					var isHitDown = hitsDown.length > 0;					var isHitStairs = hitStairs.length > 0;					//stop moving if hitting wall					if ( isHitLeft === true ) {						//moveLeft = false;						velocity.x = Math.max( 0, velocity.x );						console.log("isHitLeft");					}					if ( isHitForward  ) {						velocity.z = Math.max( 0, -velocity.z );						console.log("isHitForward");						//velocity.y +=200;					}					if (isHitStairs) {						console.log("isHitStairs");						velocity.y += 20;					}					if ( isHitStairs && moveForward ) {						velocity.y += 40;						//velocity.z -= 10;																		//velocity.y +=200;					}					if ( isHitRight === true ) {						velocity.x = Math.max( 0, -velocity.x );					}					if ( isHitBack === true ) {						velocity.z = Math.min( 0, velocity.z );											}					if ( isHitDown === true ) {						velocity.y = Math.max( 0, velocity.y );						//console.log(100-rayDown.intersectObjects(rooms)[0].distance);						controls.getObject().position.y += (myHeight-1)-rayDown.intersectObjects(rooms)[0].distance;						canJump = true;					}					controls.getObject().translateX( velocity.x * delta *speed );					controls.getObject().translateY( velocity.y * delta  );					controls.getObject().translateZ( velocity.z * delta *speed );					if ( controls.getObject().position.y < myHeight ) {						velocity.y = 0;						controls.getObject().position.y = myHeight;						canJump = true;					}						prevTime = time;										if(moveForward) {						console.log(Math.round(myPosition.x)+" , "+Math.round(myPosition.y)+" , "+Math.round(myPosition.z)+" , "+cameraDirection.x);						console.log(" ");				}				//move notification with camera				// notification.position.z = controls.getObject().position.z-5;				// notification.position.x = controls.getObject().position.x;				// notification.position.y = controls.getObject().position.y-50;				// notification.lookAt(controls.getObject().position);				  directionalLight.position.z = myPosition.z+(dLightZ)*Math.sin(t*1+Math.PI/4);				  directionalLight.position.x = myPosition.x+dLightX*Math.cos(t*1.07+Math.PI/4);				  // directionalLight.position.z = myPosition.z+700*Math.sin(t);				  // directionalLight.position.x = myPosition.x+1900*Math.cos(t+Math.PI/4);				 // directionalLight.position.z = myPosition.z+dLightZ;				 // directionalLight.position.x = myPosition.x+dLightX;				 directionalLight.position.y = myPosition.y+dLightY+70;				 directionalLight.lookAt( myPosition);				//raycaster.setFromCamera(mouse,camera);							} 				//cameraCube.rotation.copy( camera.rotation );				render();					//act on action Lists				for (var i = 0; i < lookAtMe.length; i++) {					lookAtMe[i].lookAt(myPosition);				};				for (var i = 0; i < spinList.length; i++) {					spinList[i].rotation.y += 0.01;				};				//renderer.setClearColor( 0x000000 );			}			function render() 			{					//stats.update();				updateVideos();				//renderer.render( sceneCube, cameraCube );				//renderer.render( scene, camera );				effect.render( scene, camera )			}			function updateVideos(){				for (var i = videoInfo.length - 1; i >= 0; i--) {					if (videoInfo[i].object.position.distanceTo(controls.getObject().position) <500) {						v = document.getElementById(videos[i].name);						if ( v.readyState === v.HAVE_ENOUGH_DATA ) {														videoInfo[i].context.drawImage(v,0,0);							if ( videoInfo[i].tex ) videoInfo[i].tex.needsUpdate = true;						}					}				};			};			function onMouseMove( event ) {				// calculate mouse position in normalized device coordinates				// (-1 to +1) for both components				mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;				mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;					};			function fullscreen() {	      if (container.requestFullscreen) {	        container.requestFullscreen();	      } else if (container.msRequestFullscreen) {	        container.msRequestFullscreen();	      } else if (container.mozRequestFullScreen) {	        container.mozRequestFullScreen();	      } else if (container.webkitRequestFullscreen) {	        container.webkitRequestFullscreen();	      }			window.addEventListener( 'mousemove', onMouseMove, false );					</script>	</body></html>